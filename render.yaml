services:
  # Backend Service
  - type: web
    name: itc-shield-backend
    env: python
    region: singapore
    plan: free
    buildCommand: ls -R && pip install -r backend/requirements.txt
    startCommand: ls -la && python render_entry.py
    envVars:
      - fromGroup: Tax_shield
      - key: PYTHON_VERSION
        value: 3.11.0
      - key: ALLOWED_ORIGINS
        fromService:
          type: web
          name: itc-shield-frontend
          property: host
      - key: GSP_MODE
        value: sandbox

  # Frontend Service
  - type: web
    name: itc-shield-frontend
    env: node
    region: singapore
    plan: free
    buildCommand: cd frontend/itc-shield && npm install && npm run build
    startCommand: cd frontend/itc-shield && npm start
    envVars:
      - fromGroup: Tax_shield
      - key: NODE_VERSION
        value: 20.11.0
      - key: NEXT_PUBLIC_API_URL
        fromService:
          type: web
          name: itc-shield-backend
          property: host
